version: 2.0
jobs:
  build:
    docker:
      - image: mcr.microsoft.com/dotnet/core/sdk:2.2
    steps:
      - checkout
      - run:
          name: Restore packages
          command:
            dotnet restore
      - run:
          name: Build App
          command:
            dotnet build
#      - run:
#          name: Run App
#          command:
#            dotnet run
build:
  working_directory: ~/CUSTOR.OTRLS.WEB
  docker:
    - image: circleci/node:8-browsers
  steps:
    - checkout
    - restore_cache:
        key: AngularCircleCI-{{ .Branch }}-{{ checksum "package.json" }}
    - run: npm install
    - save_cache:
        key: AngularCircleCI-{{ .Branch }}-{{ checksum "package.json" }}
        paths:
          - "node_modules"
    - run: xvfb-run -a npm run test -- --single-run --no-progress --browser=ChromeNoSandbox
    - run: xvfb-run -a npm run e2e -- --no-progress --config=protractor-ci.conf.js